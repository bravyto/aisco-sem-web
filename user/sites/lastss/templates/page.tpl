{% extends "base.tpl" %}{% block title %}{{ m.rsc[id].title }}{% endblock %}{% block chapeau %}{% include "_article_chapeau.tpl" %}{% endblock %}{% block content %}<h1>{{ m.rsc[id].title }}</h1>{% if m.rsc[id].summary %}<p class="summary">{{ m.rsc[id].summary }}</p>{% endif %}{% if m.rsc[id].amount %}<p class="amount"><b>{_ amount _}</b> : {{ m.rsc[id].amount }}</p>{% endif %}{% if m.rsc[id].programname %}<p class="programname"><b>{_ name _}</b> : {{ m.rsc[id].programname }}</p>{% endif %}<p class="programtotal" id="programtotal"><b>{_ total _}</b> : </p>{% with m.rsc[id] as r %}{% javascript %}var predId = [];var total = 0;{% endjavascript %}{% with m.search.paged[{referrers id=id page=page}] as result %}{% for id, pred_id in result %}{% javascript %}if (predId.indexOf("{{ pred_id }}") == -1) {predId.push("{{ pred_id }}");{% endjavascript %}{% for amountholder in r.s[m.rsc[pred_id].title | lower] %}{% if amountholder.amount %}{% javascript %}total += {{ amountholder.amount }};{% endjavascript %}{% endif %}{% endfor %}{% javascript %}}{% endjavascript %}{% endfor %}{% endwith %}{% javascript %}if (total == 0) { var d = document.getElementById("programtotal"); d.className += " hidden"; } else { document.getElementById("programtotal").innerHTML += total;}{% endjavascript %}{% endwith %}{% block below_summary %}{% if m.rsc[id].depiction %}<figure class="image-wrapper block-level-image">{% media m.rsc[id].depiction width=445 crop class=align alt=m.rsc[id].title %}</figure>{% endif %}{% endblock %}{{ m.rsc[id].body|show_media }}{% include "_blocks.tpl" %}{% block below_body %}{% endblock %}{% with m.search.paged[{query hassubject=[id, "haspart"] sort="seq" pagelen=1 page=q.page}] as result %}{% for id in result %}{{ m.rsc[id].title }}{% endfor %}{% pager result=result dispatch="page" id=id hide_single_page %}{% endwith %}{% endblock %}
